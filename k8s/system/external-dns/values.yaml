external-dns:
  provider: cloudflare
  domainFilters:
    - fmlab.no
  interval: 168h
  triggerLoopOnEvent: true
  env:
    - name: CF_API_TOKEN
      valueFrom:
        secretKeyRef:
          name: cloudflare-credentials
          key: api_token
    - name: CF_API_EMAIL
      valueFrom:
        secretKeyRef:
          name: cloudflare-credentials
          key: email
  extraArgs:
    - --annotation-filter=kubernetes.io/ingress.class in (traefik-external)
  sources:
    - ingress
  rbac.additionalPermissions:
    - apiGroups: ["externaldns.k8s.io"]
      resources: ["dnsendpoints"]
      verbs: ["get","watch","list"]
    - apiGroups: ["externaldns.k8s.io"]
      resources: ["dnsendpoints/status"]
      verbs: ["*"]
