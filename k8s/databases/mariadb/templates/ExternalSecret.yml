apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: "homelab-sql"
spec:
  secretStoreRef:
    name: homelab
    kind: ClusterSecretStore
  refreshInterval: "8760h" # Once each year, pretty static secrets. Will manually decrease secret when i need it to refresh.
  target:
    name: credentials-sql
    creationPolicy: Owner
    deletionPolicy: Retain
    template:
      data:
        root_password: "{{ .data.root_password }}"
        username: "{{ .data.username }}"
        password: "{{ .data.password }}"
        port: "3306"
        endpoint: "mariadb-mysql.databases.svc.cluster.local"
  dataFrom:
  - extract:
      key: homelab-sql
