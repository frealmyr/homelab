app:
  image:
    repository: mariadb
    tag: 10

  persistentVolumes:
    pvc:
      - name: config
        create: true
        size: 20Gi
        mounts:
          - path: /var/lib/mysql
            subPath: data

  mountSecrets:
    - name: credentials-sql
      secretName: credentials-sql
      mountPath: /run/secrets/sql

  # Do not attempt to "create" root again
  # https://github.com/docker-library/mysql/issues/129#issuecomment-178265632
  environmentVariables:
    MARIADB_ROOT_PASSWORD_FILE: "/run/secrets/sql/root_password"

  containerPorts:
    - name: mysql
      containerPort: 3306
      protocol: TCP

  services:
    - name: mysql
      type: ClusterIP
      ports:
        - name: mysql
          port: 3306
          targetPort: 3306
