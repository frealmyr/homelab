app:
  image:
    repository: photoprism/photoprism
    tag: arm64

  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: kubernetes.io/hostname
            operator: In
            values:
            - k8s-worker-0

  persistentVolumes:
    static:
      - name: storage
        mountPath: /photoprism/storage
      - name: originals
        mountPath: /photoprism/originals
      - name: import
        mountPath: /photoprism/import

  environmentVariables:
    PHOTOPRISM_UID: 1000
    PHOTOPRISM_GID: 1000
    PHOTOPRISM_UMASK: 0000
    PHOTOPRISM_ADMIN_USER: "admin"                 # superadmin username
    PHOTOPRISM_ADMIN_PASSWORD: "insecure"          # initial superadmin password (minimum 8 characters)
    PHOTOPRISM_AUTH_MODE: "public"               # authentication mode (public, password)
    PHOTOPRISM_SITE_URL: "https://photos.fmlab.no/"  # server URL in the format "http(s)://domain.name(:port)/(path)"
    PHOTOPRISM_ORIGINALS_LIMIT: 5000               # file size limit for originals in MB (increase for high-res video)
    PHOTOPRISM_HTTP_COMPRESSION: "none"            # improves transfer speed and bandwidth utilization (none or gzip)
    PHOTOPRISM_WORKERS: 2                          # limits the number of indexing workers to reduce system load
    PHOTOPRISM_LOG_LEVEL: "info"                   # log level: trace, debug, info, warning, error, fatal, or panic
    PHOTOPRISM_READONLY: "false"                   # do not modify originals directory (reduced functionality)
    PHOTOPRISM_EXPERIMENTAL: "false"               # enables experimental features
    PHOTOPRISM_DISABLE_CHOWN: "false"              # disables updating storage permissions via chmod and chown on startup
    PHOTOPRISM_DISABLE_WEBDAV: "false"             # disables built-in WebDAV server
    PHOTOPRISM_DISABLE_SETTINGS: "false"           # disables Settings in Web UI
    PHOTOPRISM_DISABLE_TENSORFLOW: "true"         # disables all features depending on TensorFlow
    PHOTOPRISM_DISABLE_RAW: "true"                # disables indexing and conversion of RAW files
    PHOTOPRISM_JPEG_QUALITY: 97                    # a higher value increases the quality and file size of JPEG images and thumbnails (25-100)
    PHOTOPRISM_DATABASE_DRIVER: "mysql"            # use MariaDB 10.5+ or MySQL 8+ instead of SQLite for improved performance
    PHOTOPRISM_DATABASE_SERVER: "mariadb-mysql.databases.svc.cluster.local:3306"     # MariaDB or MySQL database server (hostname:port)
    PHOTOPRISM_DATABASE_NAME: "photoprism"         # MariaDB or MySQL database schema name
    PHOTOPRISM_SITE_CAPTION: "PhotoLab"
    PHOTOPRISM_SITE_DESCRIPTION: ""                # meta site description
    PHOTOPRISM_SITE_AUTHOR: "Fredrick Myrvoll"                     # meta site author

  secretEnvironmentVariables:
    - name: PHOTOPRISM_DATABASE_USER
      secret:
        name: credentials-db-photoprism
        key: username
    - name: PHOTOPRISM_DATABASE_PASSWORD
      secret:
        name: credentials-db-photoprism
        key: password

  additionalContainers:
    - name: cloudflare-tunnel
      image:
        repository: milgradesec/cloudflared
        tag: latest
      command:
        - /usr/local/bin/cloudflared
        - '--no-autoupdate'
        - tunnel
        - run
      secretEnvironmentVariables:
        - name: TUNNEL_TOKEN
          secret:
            name: credentials-cloudflare-tunnel
            key: token
