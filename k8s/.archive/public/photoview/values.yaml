app:
  image:
    repository: viktorstrate/photoview
    tag: 2.3.13

  persistentVolumes:
    static:
      - name: cache
        mountPath: /app/cache
      - name: sqlite
        mountPath: /app/database
    # nfs:
    #   - name: gallery
    #     server: 10.7.0.11
    #     remotePath: /volume2/gallery
    #     mountPath: /app/gallery

  environmentVariables:
    PHOTOVIEW_LISTEN_IP: 0.0.0.0
    PHOTOVIEW_LISTEN_PORT: 8080
    PHOTOVIEW_DEVELOPMENT_MODE: false
    PHOTOVIEW_DISABLE_FACE_RECOGNITION: true
    PHOTOVIEW_DATABASE_DRIVER: sqlite
    PHOTOVIEW_MEDIA_CACHE: /app/cache
    PHOTOVIEW_SQLITE_PATH: /app/database/photoview.db

  secretEnvironmentVariables:
    - name: MAPBOX_TOKEN
      secret:
        name: credentials-app
        key: mapbox-token

  containerPorts:
    - name: http
      containerPort: 8080
      protocol: TCP

  services:
    - name: http
      type: ClusterIP
      ports:
        - name: http
          port: 8080
          targetPort: 8080

  ingresses:
    enabled: true
    className: traefik-external
    ingress:
      - name: frontend
        service:
          name: http
          port: 8080
        hosts:
          - host: photos.fmlab.no
            paths:
              - path: /
                pathType: ImplementationSpecific
        tls:
          - secretName: photoview
            hosts:
              - photos.fmlab.no
