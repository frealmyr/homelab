version: '3.9'

networks:
  web:
    external: true

volumes:
  config:

services:
  transmission:
    container_name: transmission
    image: gists/transmission:latest
    ports:
      - 54213:51413
      - 54213:51413/udp
    environment:
      - USERNAME=${TRANSMISSION_USER}
      - PASSWORD=${TRANSMISSION_PASS}
    networks:
      - web
    volumes:
      - config:/data/.config
      - $HOME/Storage/Downloads:/data/downloads
      - /media/HDD1:/media/HDD1
      - /media/HDD2:/media/HDD2
      - /media/HDD3:/media/HDD3
    labels:
      - traefik.enable=true
      - traefik.docker.network=web
      - traefik.http.routers.${PROJECT}.entryPoints=https
      - traefik.http.routers.${PROJECT}.rule=Host(`${TRAEFIK_HOSTNAME}`)
      - traefik.http.routers.${PROJECT}.service=${PROJECT}
      - traefik.http.routers.${PROJECT}.tls.certresolver=letsEncrypt
      - traefik.http.services.${PROJECT}.loadbalancer.server.port=${TRAEFIK_PORT}
      - traefik.http.routers.${PROJECT}.middlewares=sso@file,security@file
    restart: unless-stopped
