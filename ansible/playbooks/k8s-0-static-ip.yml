---
- hosts: all
  become: true
  max_fail_percentage: 0

  tasks:

    - name: network - create interface file if it does not exist
      file:
        path: /etc/network/interfaces.d/eth0
        state: touch

    - name: network - configure static ip
      blockinfile:
        path: /etc/network/interfaces.d/eth0
        block: |
          auto eth0
          iface eth0 inet static
              address {{ ansible_default_ipv4.address|default(ansible_all_ipv4_addresses[0]) }}
              netmask 255.255.255.0
              network 10.8.0.0
              broadcast 10.8.0.255
              gateway 10.8.0.1

    - name: network - disable dhcpcd service
      systemd:
        name: "dhcpcd.service"
        enabled: no
        masked: yes
        state: stopped
