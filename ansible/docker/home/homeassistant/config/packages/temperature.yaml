input_number:
  temperature_comfort_stue:
    name: Temperature Comfort - Stue
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_sleep_stue:
    name: Temperature Sleep - Stue
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_away_stue:
    name: Temperature Away - Stue
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_comfort_soverom:
    name: Temperature Comfort - Soverom
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_sleep_soverom:
    name: Temperature Sleep - Soverom
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_away_soverom:
    name: Temperature Away - Soverom
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_comfort_gjesterom:
    name: Temperature Comfort - Gjesterom
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_sleep_gjesterom:
    name: Temperature Sleep - Gjesterom
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_away_gjesterom:
    name: Temperature Away - Gjesterom
    min: 10
    max: 23
    step: 0.5
    mode: slider
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  temperature_override_target_stue:
    name: Temperature Override - Stue
    min: 0
    max: 24
    step: 1
    mode: slider
    unit_of_measurement: "Hours"
    icon: mdi:clock
  temperature_override_target_soverom:
    name: Temperature Override - Soverom
    min: 0
    max: 24
    step: 1
    mode: slider
    unit_of_measurement: "Hours"
    icon: mdi:clock
  temperature_override_target_gjesterom:
    name: Temperature Override - Gjesterom
    min: 0
    max: 24
    step: 1
    mode: slider
    unit_of_measurement: "Hours"
    icon: mdi:clock

input_boolean:
  temperature_override_toggle_stue:
    name: Temperature Override Toggle - Stue
    icon: mdi:thermometer
  temperature_override_toggle_soverom:
    name: Temperature Override Toggle - Soverom
    icon: mdi:thermometer
  temperature_override_toggle_gjesterom:
    name: Temperature Override Toggle - Gjesterom
    icon: mdi:thermometer

input_datetime:
  temperature_override_duration_stue:
    name: Temperature Override Duration - Stue
    has_time: true
    icon: mdi:clock
  temperature_override_duration_soverom:
    name:  Temperature Override Duration - Soverom
    has_time: true
    icon: mdi:clock
  temperature_override_duration_gjesterom:
    name:  Temperature Override Duration - Gjesterom
    has_time: true
    icon: mdi:clock

timer:
  temperature_override_timer_stue:
    name: Temperature Override Timer - Stue
    icon: mdi:clock
    restore: true
  temperature_override_timer_overom:
    name: Temperature Override Timer - Soverom
    icon: mdi:clock
    restore: true
  temperature_override_timer_gjesterom:
    name: Temperature Override Timer - Gjesterom
    icon: mdi:clock
    restore: true

sensor:
  - platform: integration
    name: panel_office_power_accumulated
    unique_id: panel_office_power_accumulated
    source: sensor.panel_office_current_power
    round: 4
    unit_prefix: k
    method: left
  - platform: integration
    name: panel_bedroom_power_accumulated
    unique_id: panel_bedroom_power_accumulated
    source: sensor.panel_bedroom_current_power
    round: 4
    unit_prefix: k
    method: left
  - platform: integration
    name: radiator_kitchen_power_accumulated
    unique_id: radiator_kitchen_power_accumulated
    source: sensor.radiator_kitchen_current_power
    round: 4
    unit_prefix: k
    method: left
  - platform: integration
    name: radiator_lounge_power_accumulated
    unique_id: radiator_lounge_power_accumulated
    source: sensor.radiator_lounge_current_power
    round: 4
    unit_prefix: k
    method: left

utility_meter:
  panel_office_power_accumulated_daily:
    unique_id: panel_office_power_accumulated_daily
    source: sensor.panel_office_power_accumulated
    cycle: daily
  panel_office_power_accumulated_weekly:
    unique_id: panel_office_power_accumulated_weekly
    source: sensor.panel_office_power_accumulated
    cycle: weekly
  panel_office_power_accumulated_monthly:
    unique_id: panel_office_power_accumulated_monthly
    source: sensor.panel_office_power_accumulated
    cycle: monthly
  panel_bedroom_power_accumulated_daily:
    unique_id: panel_bedroom_power_accumulated_daily
    source: sensor.panel_bedroom_power_accumulated
    cycle: daily
  panel_bedroom_power_accumulated_weekly:
    unique_id: panel_bedroom_power_accumulated_weekly
    source: sensor.panel_bedroom_power_accumulated
    cycle: weekly
  panel_bedroom_power_accumulated_monthly:
    unique_id: panel_bedroom_power_accumulated_monthly
    source: sensor.panel_bedroom_power_accumulated
    cycle: monthly
  radiator_kitchen_power_accumulated_daily:
    unique_id: radiator_kitchen_power_accumulated_daily
    source: sensor.radiator_kitchen_power_accumulated
    cycle: daily
  radiator_kitchen_power_accumulated_weekly:
    unique_id: radiator_kitchen_power_accumulated_weekly
    source: sensor.radiator_kitchen_power_accumulated
    cycle: weekly
  radiator_kitchen_power_accumulated_monthly:
    unique_id: radiator_kitchen_power_accumulated_monthly
    source: sensor.radiator_kitchen_power_accumulated
    cycle: monthly
  radiator_lounge_power_accumulated_daily:
    unique_id: radiator_lounge_power_accumulated_daily
    source: sensor.radiator_lounge_power_accumulated
    cycle: daily
  radiator_lounge_power_accumulated_weekly:
    unique_id: radiator_lounge_power_accumulated_weekly
    source: sensor.radiator_lounge_power_accumulated
    cycle: weekly
  radiator_lounge_power_accumulated_monthly:
    unique_id: radiator_lounge_power_accumulated_monthly
    source: sensor.radiator_lounge_power_accumulated
    cycle: monthly

template:
  - sensor:
    - unique_id: "panel_office_power_percentage_daily"
      unit_of_measurement: '%'
      availability: >-
        {{ is_number(states('sensor.accumulated_consumption_bunesvegen_19')) }}
        {{ is_number(states('sensor.panel_office_power_accumulated_daily')) }}
      state: >-
        {% set panel_office = states('sensor.panel_office_power_accumulated_daily') | float %}
        {% set total_usage = states('sensor.accumulated_consumption_bunesvegen_19') | float %}
        {{ ( (panel_office / total_usage) * 100 | float ) | round(2) }}
  - sensor:
    - unique_id: "panel_bedroom_power_percentage_daily"
      unit_of_measurement: '%'
      availability: >-
        {{ is_number(states('sensor.accumulated_consumption_bunesvegen_19')) }}
        {{ is_number(states('sensor.panel_bedroom_power_accumulated_daily')) }}
      state: >-
        {% set panel_bedroom = states('sensor.panel_bedroom_power_accumulated_daily') | float %}
        {% set total_usage = states('sensor.accumulated_consumption_bunesvegen_19') | float %}
        {{ ( (panel_bedroom / total_usage) * 100 | float ) | round(2) }}
  - sensor:
    - unique_id: "radiator_livingroom_power_percentage_daily"
      unit_of_measurement: '%'
      availability: >-
        {{ is_number(states('sensor.accumulated_consumption_bunesvegen_19')) }}
        {{ is_number(states('sensor.radiator_kitchen_power_accumulated_daily')) }}
        {{ is_number(states('sensor.radiator_lounge_power_accumulated_daily')) }}
      state: >-
        {% set radiator_kitchen = states('sensor.radiator_kitchen_power_accumulated_daily') | float %}
        {% set radiator_lounge = states('sensor.radiator_lounge_power_accumulated_daily') | float %}
        {% set total_usage = states('sensor.accumulated_consumption_bunesvegen_19') | float %}
        {{ ( ((radiator_kitchen + radiator_lounge) / total_usage) * 100 | float ) | round(2) }}
