---
- hosts: localhost
  become: yes
  tasks:
    - name: update & upgrade apt packages
      apt:
        upgrade: full
        update_cache: yes
        cache_valid_time: 3600

    - name: add apt signing keys
      ansible.builtin.apt_key:
        url: "{{ item }}"
        state: present
      with_items:
        - "https://download.spotify.com/debian/pubkey_5E3C45D7B312C643.gpg"

    - name: add apt repositories
      ansible.builtin.apt_repository:
        repo: "{{ item }}"
        state: present
      with_items:
        - "deb http://repository.spotify.com stable non-free"
        - "ppa:team-xbmc/ppa"

    - name: install apt packages
      apt:
        pkg:
        - bat
        - curl
        - flatpak
        - git
        - htop
        - inxi
        - kodi
        - linux-tools-common
        - linux-tools-generic
        - mc
        - net-tools
        - snapd
        - spotify-client
        - tmux
        - ubuntu-restricted-extras
        - xclip
        - zsh

    - name: install deb packages
      apt:
        deb: "{{ item }}"
      with_items:
        - https://discord.com/api/download?platform=linux&format=deb

    - name: clean & remove apt packages
      apt:
        autoclean: yes
        autoremove: yes

    - name: install snap packages
      community.general.snap:
        name:
          - geforcenow-electron
          - moonlight

    - name: add the flathub flatpak repository
      community.general.flatpak_remote:
        name: flathub
        state: present
        flatpakrepo_url: https://dl.flathub.org/repo/flathub.flatpakrepo
        method: user
      become_user: fredrick
