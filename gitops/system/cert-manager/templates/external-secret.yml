---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: "cloudflare-credentials"
spec:
  secretStoreRef:
    name: homelab
    kind: ClusterSecretStore
  refreshInterval: "8760h" # Once each year, pretty static secrets. Will manually decrease secret when i need it to refresh.
  target:
    name: cloudflare-credentials
    creationPolicy: Owner
    deletionPolicy: Retain
    template:
      data:
        api_token: '{{"{{"}} .cloudflare_api_token {{"}}"}}'
  dataFrom:
  - extract:
      key: homelab-apps
      property: cloudflare_api_token
